[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Grill Cube Driver 1.1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-remote-resources-plugin:1.5:process (default) @ grill-driver-cube ---
[INFO] 
[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ grill-driver-cube ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ grill-driver-cube ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ grill-driver-cube ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ grill-driver-cube ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 3 source files to /Users/amareshwari.sr/workspace/grill-external/grill-driver-cube/target/test-classes
[WARNING] Note: /Users/amareshwari.sr/workspace/grill-external/grill-driver-cube/src/test/java/com/inmobi/grill/driver/cube/TestCubeDriver.java uses or overrides a deprecated API.
[WARNING] Note: Recompile with -Xlint:deprecation for details.
[INFO] 
[INFO] --- maven-surefire-plugin:2.15:test (default-test) @ grill-driver-cube ---
[INFO] Surefire report directory: /Users/amareshwari.sr/workspace/grill-external/grill-driver-cube/target/surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running com.inmobi.grill.driver.cube.TestRewriting
Configuring TestNG with: TestNG652Configurator
2014-07-15 12:51:05,682 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select name from table
2014-07-15 12:51:06,137 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,151 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            table
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,159 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,166 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABREF Type:853
2014-07-15 12:51:06,173 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:06,180 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:table Type:26
2014-07-15 12:51:06,193 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,208 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,224 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,234 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,238 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:06,242 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:name Type:26
2014-07-15 12:51:06,246 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select name from table
2014-07-15 12:51:06,247 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,250 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            table
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,257 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,261 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABREF Type:853
2014-07-15 12:51:06,265 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:06,269 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:table Type:26
2014-07-15 12:51:06,272 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,276 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,279 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,282 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,284 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:06,286 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:name Type:26
2014-07-15 12:51:06,290 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select name from table
2014-07-15 12:51:06,291 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: cube select name from table
2014-07-15 12:51:06,294 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,295 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   cube
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            table
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,297 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,298 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,300 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@36c3e82b query:cube select name from table
2014-07-15 12:51:06,302 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: cube select name from table
2014-07-15 12:51:06,303 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,305 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   cube
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            table
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,308 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,309 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,311 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@77bf7b23 query:cube select name from table
2014-07-15 12:51:06,312 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,373 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,374 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,375 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,377 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is:  select name from table
2014-07-15 12:51:06,378 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite directory '/tmp/rewrite' cube select name from table
2014-07-15 12:51:06,382 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,383 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   cube
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            table
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            '/tmp/rewrite'
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,385 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,385 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,386 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@580754fc query:cube select name from table
2014-07-15 12:51:06,387 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite directory '/tmp/rewrite' cube select name from table
2014-07-15 12:51:06,388 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,391 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   cube
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            table
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            '/tmp/rewrite'
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,392 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,393 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,394 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@495c998a query:cube select name from table
2014-07-15 12:51:06,396 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,425 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,426 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,428 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,430 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: insert overwrite directory '/tmp/rewrite'  select name from table
2014-07-15 12:51:06,431 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite local directory '/tmp/rewrite' cube select name from table
2014-07-15 12:51:06,432 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,433 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   cube
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            table
   TOK_INSERT
      TOK_DESTINATION
         TOK_LOCAL_DIR
            '/tmp/rewrite'
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,434 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,435 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,436 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6c63a721 query:cube select name from table
2014-07-15 12:51:06,438 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite local directory '/tmp/rewrite' cube select name from table
2014-07-15 12:51:06,438 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,439 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   cube
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            table
   TOK_INSERT
      TOK_DESTINATION
         TOK_LOCAL_DIR
            '/tmp/rewrite'
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,441 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,441 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,442 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@2719f1f query:cube select name from table
2014-07-15 12:51:06,444 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,471 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,472 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,473 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,477 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: insert overwrite local directory '/tmp/rewrite'  select name from table
2014-07-15 12:51:06,477 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite local directory '/tmp/example-output' cube select id,name from dim_table
2014-07-15 12:51:06,479 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,480 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   cube
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            dim_table
   TOK_INSERT
      TOK_DESTINATION
         TOK_LOCAL_DIR
            '/tmp/example-output'
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               id
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,482 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,482 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,483 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6bd9e2c7 query:cube select id,name from dim_table
2014-07-15 12:51:06,484 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite local directory '/tmp/example-output' cube select id,name from dim_table
2014-07-15 12:51:06,486 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,486 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   cube
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            dim_table
   TOK_INSERT
      TOK_DESTINATION
         TOK_LOCAL_DIR
            '/tmp/example-output'
      TOK_SELECT
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               id
         TOK_SELEXPR
            TOK_TABLE_OR_COL
               name

2014-07-15 12:51:06,487 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,488 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,488 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@2db7ae22 query:cube select id,name from dim_table
2014-07-15 12:51:06,489 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select id,name from dim_table
2014-07-15 12:51:06,510 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select id,name from dim_table
2014-07-15 12:51:06,511 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,512 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select id,name from dim_table
2014-07-15 12:51:06,514 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: insert overwrite local directory '/tmp/example-output'  select id,name from dim_table
2014-07-15 12:51:06,515 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: explain cube select name from table
2014-07-15 12:51:06,517 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,518 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_EXPLAIN
   TOK_QUERY
      cube
      TOK_FROM
         TOK_TABREF
            TOK_TABNAME
               table
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_TABLE_OR_COL
                  name

2014-07-15 12:51:06,519 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,520 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,520 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,521 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@799e11a1 query:cube select name from table
2014-07-15 12:51:06,522 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: explain cube select name from table
2014-07-15 12:51:06,523 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,524 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_EXPLAIN
   TOK_QUERY
      cube
      TOK_FROM
         TOK_TABREF
            TOK_TABNAME
               table
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_TABLE_OR_COL
                  name

2014-07-15 12:51:06,525 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,526 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,526 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,528 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@78979f67 query:cube select name from table
2014-07-15 12:51:06,529 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,548 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,549 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,550 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,552 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: explain  select name from table
2014-07-15 12:51:06,552 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table) a
2014-07-15 12:51:06,556 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,557 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,558 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,559 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,561 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,562 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,562 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,564 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6f03de90 query:cube select name from table
2014-07-15 12:51:06,565 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,566 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,566 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,567 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,570 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,571 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table) a
2014-07-15 12:51:06,572 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,573 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,574 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,574 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,575 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,576 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,577 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,578 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6708f8e0 query:cube select name from table
2014-07-15 12:51:06,583 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,584 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,585 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,586 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,586 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,587 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,605 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,606 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,607 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,609 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table) a
2014-07-15 12:51:06,610 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite directory '/tmp/rewrite' select * from (cube select name from table) a
2014-07-15 12:51:06,611 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,612 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            '/tmp/rewrite'
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,613 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,614 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,615 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,616 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,616 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,617 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@163b4b1e query:cube select name from table
2014-07-15 12:51:06,618 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,619 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,620 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:'/tmp/rewrite' Type:301
2014-07-15 12:51:06,621 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,622 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,623 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite directory '/tmp/rewrite' select * from (cube select name from table) a
2014-07-15 12:51:06,625 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,626 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            '/tmp/rewrite'
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,626 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,627 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,627 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,628 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,628 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,629 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@ec0a9f9 query:cube select name from table
2014-07-15 12:51:06,630 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,630 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,631 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:'/tmp/rewrite' Type:301
2014-07-15 12:51:06,631 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,632 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,632 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,651 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,652 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,653 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,654 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: insert overwrite directory '/tmp/rewrite' select * from ( select name from table) a
2014-07-15 12:51:06,654 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table)a
2014-07-15 12:51:06,655 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,656 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,657 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,657 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,658 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,659 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,659 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,660 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@5fa80aea query:cube select name from table
2014-07-15 12:51:06,661 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,661 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,662 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,663 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,664 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,664 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table)a
2014-07-15 12:51:06,665 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,666 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,667 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,667 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,668 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,668 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,669 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,670 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@1164b9b6 query:cube select name from table
2014-07-15 12:51:06,671 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,672 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,672 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,673 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,674 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,675 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,694 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,694 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,695 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,696 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table)a
2014-07-15 12:51:06,696 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from  (  cube select name from table   )     a
2014-07-15 12:51:06,697 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,698 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,701 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,702 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,702 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,703 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,703 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,704 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@24e33e18 query:cube select name from table
2014-07-15 12:51:06,705 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,706 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,706 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,707 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,707 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,708 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from  (  cube select name from table   )     a
2014-07-15 12:51:06,709 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,710 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,711 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,711 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,712 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,712 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,713 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,714 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@4301ac93 query:cube select name from table
2014-07-15 12:51:06,715 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,715 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,716 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,717 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,718 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,718 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,736 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,737 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,738 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,740 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from  (   select name from table   )     a
2014-07-15 12:51:06,741 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (      cube select name from table where (name = 'ABC' OR name = 'XYZ') AND (key=100)   )       a
2014-07-15 12:51:06,753 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,754 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
               TOK_WHERE
                  AND
                     OR
                        =
                           TOK_TABLE_OR_COL
                              name
                           'ABC'
                        =
                           TOK_TABLE_OR_COL
                              name
                           'XYZ'
                     =
                        TOK_TABLE_OR_COL
                           key
                        100
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,754 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,755 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,756 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,757 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,757 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,759 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@4402a6ff query:cube select name from table where (name = 'ABC' OR name = 'XYZ') AND (key=100)
2014-07-15 12:51:06,760 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,760 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,761 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,762 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,763 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,764 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (      cube select name from table where (name = 'ABC' OR name = 'XYZ') AND (key=100)   )       a
2014-07-15 12:51:06,767 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,768 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_QUERY
            cube
            TOK_FROM
               TOK_TABREF
                  TOK_TABNAME
                     table
            TOK_INSERT
               TOK_DESTINATION
                  TOK_DIR
                     TOK_TMP_FILE
               TOK_SELECT
                  TOK_SELEXPR
                     TOK_TABLE_OR_COL
                        name
               TOK_WHERE
                  AND
                     OR
                        =
                           TOK_TABLE_OR_COL
                              name
                           'ABC'
                        =
                           TOK_TABLE_OR_COL
                              name
                           'XYZ'
                     =
                        TOK_TABLE_OR_COL
                           key
                        100
         a
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,769 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,770 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,770 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,771 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,772 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,773 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@a21d23b query:cube select name from table where (name = 'ABC' OR name = 'XYZ') AND (key=100)
2014-07-15 12:51:06,774 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,774 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,775 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,776 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,776 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,777 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table where (name = 'ABC' OR name = 'XYZ') AND (key=100)
2014-07-15 12:51:06,795 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table where (name = 'ABC' OR name = 'XYZ') AND (key=100)
2014-07-15 12:51:06,797 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,798 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table where (name = 'ABC' OR name = 'XYZ') AND (key=100)
2014-07-15 12:51:06,799 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from (       select name from table where (name = 'ABC' OR name = 'XYZ') AND (key=100)   )       a
2014-07-15 12:51:06,799 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table) a join (cube select name2 from table2) b
2014-07-15 12:51:06,802 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,803 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_JOIN
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            a
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
            b
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,804 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,805 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_JOIN Type:703
2014-07-15 12:51:06,806 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,806 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,807 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,807 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,808 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@3fbfbfb8 query:cube select name from table
2014-07-15 12:51:06,809 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,814 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,814 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,815 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@1b0c6cfc query:cube select name2 from table2
2014-07-15 12:51:06,816 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,817 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,818 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,819 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,820 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,821 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table) a join (cube select name2 from table2) b
2014-07-15 12:51:06,823 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,824 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_JOIN
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            a
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
            b
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,825 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,826 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_JOIN Type:703
2014-07-15 12:51:06,827 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,830 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,831 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,831 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,833 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@4cc72243 query:cube select name from table
2014-07-15 12:51:06,834 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,835 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,836 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,837 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@259a8416 query:cube select name2 from table2
2014-07-15 12:51:06,838 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,840 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,841 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,842 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,843 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,843 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,863 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,864 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,865 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,866 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:06,885 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:06,886 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,887 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:06,888 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table) a join ( select name2 from table2) b
2014-07-15 12:51:06,889 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table) a full outer join (cube select name2 from table2) b on a.name=b.name2
2014-07-15 12:51:06,893 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,894 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_FULLOUTERJOIN
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            a
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
            b
         =
            .
               TOK_TABLE_OR_COL
                  a
               name
            .
               TOK_TABLE_OR_COL
                  b
               name2
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,895 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,895 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FULLOUTERJOIN Type:673
2014-07-15 12:51:06,896 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,896 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,897 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,897 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,898 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6d732ed2 query:cube select name from table
2014-07-15 12:51:06,899 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,899 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,899 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,900 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@25071521 query:cube select name2 from table2
2014-07-15 12:51:06,901 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:06,901 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:06,902 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:a Type:26
2014-07-15 12:51:06,902 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:06,903 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:b Type:26
2014-07-15 12:51:06,903 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,904 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,904 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,905 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,905 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,906 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table) a full outer join (cube select name2 from table2) b on a.name=b.name2
2014-07-15 12:51:06,908 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,909 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_FULLOUTERJOIN
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            a
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
            b
         =
            .
               TOK_TABLE_OR_COL
                  a
               name
            .
               TOK_TABLE_OR_COL
                  b
               name2
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,910 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,911 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FULLOUTERJOIN Type:673
2014-07-15 12:51:06,911 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,912 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,913 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,913 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,914 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@34e93999 query:cube select name from table
2014-07-15 12:51:06,915 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,916 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,916 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,917 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@3bc486f2 query:cube select name2 from table2
2014-07-15 12:51:06,918 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:06,919 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:06,919 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:a Type:26
2014-07-15 12:51:06,920 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:06,920 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:b Type:26
2014-07-15 12:51:06,922 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,923 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,924 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,924 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,925 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,925 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:06,940 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:06,941 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,941 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:06,942 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:06,956 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:06,957 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,958 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:06,959 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table) a full outer join ( select name2 from table2) b on a.name=b.name2
2014-07-15 12:51:06,959 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table) a join (select name2 from table2) b
2014-07-15 12:51:06,961 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,962 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_JOIN
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            a
         TOK_SUBQUERY
            TOK_QUERY
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
            b
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,962 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,963 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_JOIN Type:703
2014-07-15 12:51:06,964 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,964 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,965 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,965 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,966 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@126d2380 query:cube select name from table
2014-07-15 12:51:06,967 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,968 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,968 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABREF Type:853
2014-07-15 12:51:06,969 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:06,970 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:table2 Type:26
2014-07-15 12:51:06,970 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,971 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,971 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,972 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,973 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:06,973 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:name2 Type:26
2014-07-15 12:51:06,974 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,975 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,976 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,976 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,977 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,978 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table) a join (select name2 from table2) b
2014-07-15 12:51:06,980 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:06,980 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_JOIN
         TOK_SUBQUERY
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            a
         TOK_SUBQUERY
            TOK_QUERY
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
            b
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:06,981 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,981 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_JOIN Type:703
2014-07-15 12:51:06,982 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:06,982 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,983 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:06,983 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:06,984 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@3b35b1f3 query:cube select name from table
2014-07-15 12:51:06,985 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:06,985 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:06,986 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABREF Type:853
2014-07-15 12:51:06,986 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:06,987 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:table2 Type:26
2014-07-15 12:51:06,987 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,988 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,988 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,989 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,990 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:06,990 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:name2 Type:26
2014-07-15 12:51:06,991 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:06,992 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:06,993 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:06,993 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:06,994 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:06,995 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,011 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,012 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,013 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,014 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table) a join (select name2 from table2) b
2014-07-15 12:51:07,014 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2) u
2014-07-15 12:51:07,017 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,018 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,018 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,021 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,021 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,022 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,023 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,023 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,024 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@351daa0e query:cube select name from table
2014-07-15 12:51:07,025 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,025 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,025 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,026 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@2e879860 query:cube select name2 from table2
2014-07-15 12:51:07,027 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,027 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,028 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,029 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,029 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,030 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2) u
2014-07-15 12:51:07,032 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,032 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,033 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,033 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,034 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,035 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,035 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,036 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,037 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@4824de7d query:cube select name from table
2014-07-15 12:51:07,037 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,038 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,038 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,039 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6c8b058b query:cube select name2 from table2
2014-07-15 12:51:07,039 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,040 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,040 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,041 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,041 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,042 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,056 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,057 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,058 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,058 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,073 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,074 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,074 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,075 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table union all  select name2 from table2) u
2014-07-15 12:51:07,076 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2) u
2014-07-15 12:51:07,078 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,079 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,080 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,080 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,081 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,082 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,083 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,083 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,084 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@51f21c50 query:cube select name from table
2014-07-15 12:51:07,085 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,085 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,086 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,087 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6e20f237 query:cube select name2 from table2
2014-07-15 12:51:07,088 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,088 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,089 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,090 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,091 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,092 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,105 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,106 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,107 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,107 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,120 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,121 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,122 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,123 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table union all  select name2 from table2) u
2014-07-15 12:51:07,123 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite directory '/tmp/rewrite' select * from (cube select name from table union all cube select name2 from table2) u
2014-07-15 12:51:07,125 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,126 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            '/tmp/rewrite'
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,128 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,129 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,130 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,131 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,132 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,132 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,133 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@46dd75a4 query:cube select name from table
2014-07-15 12:51:07,134 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,135 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,135 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,136 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@75568654 query:cube select name2 from table2
2014-07-15 12:51:07,137 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,138 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,139 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:'/tmp/rewrite' Type:301
2014-07-15 12:51:07,140 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,140 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,142 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite directory '/tmp/rewrite' select * from (cube select name from table union all cube select name2 from table2) u
2014-07-15 12:51:07,144 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,144 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            '/tmp/rewrite'
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,145 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,146 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,147 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,148 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,149 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,149 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,150 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@275e538e query:cube select name from table
2014-07-15 12:51:07,151 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,151 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,152 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,153 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@21bfa3d3 query:cube select name2 from table2
2014-07-15 12:51:07,154 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,155 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,155 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:'/tmp/rewrite' Type:301
2014-07-15 12:51:07,156 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,157 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,158 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,174 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,175 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,176 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,176 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,189 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,190 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,191 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,191 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: insert overwrite directory '/tmp/rewrite' select * from ( select name from table union all  select name2 from table2) u
2014-07-15 12:51:07,192 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: insert overwrite directory '/tmp/rewrite' select * from (cube select name from table union all cube select name2 from table2) u
2014-07-15 12:51:07,193 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,194 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            '/tmp/rewrite'
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,194 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,195 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,195 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,196 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,197 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,197 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,198 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@18f6559 query:cube select name from table
2014-07-15 12:51:07,198 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,199 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,199 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,200 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6d46b6db query:cube select name2 from table2
2014-07-15 12:51:07,201 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,201 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,202 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:'/tmp/rewrite' Type:301
2014-07-15 12:51:07,202 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,203 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,204 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,215 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,216 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,217 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,217 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,231 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,232 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,232 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,236 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: insert overwrite directory '/tmp/rewrite' select * from ( select name from table union all  select name2 from table2) u
2014-07-15 12:51:07,237 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select u.* from (select name from table    union all       cube select name2 from table2)   u
2014-07-15 12:51:07,238 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,239 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF
               TOK_TABNAME
                  u

2014-07-15 12:51:07,239 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,240 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,241 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,241 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,242 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,243 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABREF Type:853
2014-07-15 12:51:07,244 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,244 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:table Type:26
2014-07-15 12:51:07,245 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,246 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,246 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,247 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,248 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,249 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:name Type:26
2014-07-15 12:51:07,250 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,250 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,250 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,251 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@5721df2a query:cube select name2 from table2
2014-07-15 12:51:07,252 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,253 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,254 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,254 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,255 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,256 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,257 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,258 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select u.* from (select name from table    union all       cube select name2 from table2)   u
2014-07-15 12:51:07,259 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,260 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF
               TOK_TABNAME
                  u

2014-07-15 12:51:07,261 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,262 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,262 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,263 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,263 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,264 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABREF Type:853
2014-07-15 12:51:07,265 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,265 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:table Type:26
2014-07-15 12:51:07,266 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,266 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,267 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,268 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,269 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,269 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:name Type:26
2014-07-15 12:51:07,270 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,270 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,271 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,271 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@70c26b16 query:cube select name2 from table2
2014-07-15 12:51:07,272 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,272 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,273 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,273 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,274 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,274 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,275 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,276 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,287 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,287 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,288 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,289 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select u.* from (select name from table    union all        select name2 from table2)   u
2014-07-15 12:51:07,290 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select u.* from (select name from table union all cube select name2 from table2)u
2014-07-15 12:51:07,291 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,292 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF
               TOK_TABNAME
                  u

2014-07-15 12:51:07,293 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,294 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,294 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,295 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,296 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,297 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABREF Type:853
2014-07-15 12:51:07,298 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,299 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:table Type:26
2014-07-15 12:51:07,300 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,301 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,302 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,302 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,303 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,304 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:name Type:26
2014-07-15 12:51:07,304 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,305 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,305 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,306 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@2682d210 query:cube select name2 from table2
2014-07-15 12:51:07,306 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,307 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,307 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,308 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,309 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,309 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,310 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,312 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select u.* from (select name from table union all cube select name2 from table2)u
2014-07-15 12:51:07,313 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,314 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF
               TOK_TABNAME
                  u

2014-07-15 12:51:07,315 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,315 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,316 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,317 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,318 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,318 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABREF Type:853
2014-07-15 12:51:07,319 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,320 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:table Type:26
2014-07-15 12:51:07,320 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,321 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,322 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,323 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,324 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,324 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:name Type:26
2014-07-15 12:51:07,325 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,325 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,326 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,327 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@3302fc5 query:cube select name2 from table2
2014-07-15 12:51:07,327 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,328 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,329 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,330 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,330 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,331 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,332 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,333 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,347 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,348 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,349 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,350 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select u.* from (select name from table union all  select name2 from table2)u
2014-07-15 12:51:07,350 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2 union all cube select name3 from table3) u
2014-07-15 12:51:07,352 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,353 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_UNION
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table2
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name2
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table3
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name3
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,354 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,355 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,356 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,356 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,357 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,358 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,358 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,359 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@2a48f675 query:cube select name from table
2014-07-15 12:51:07,360 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,360 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,361 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,362 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@1c2c9103 query:cube select name2 from table2
2014-07-15 12:51:07,363 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,363 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,364 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,365 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@31e46a68 query:cube select name3 from table3
2014-07-15 12:51:07,366 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,367 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,367 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,368 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,369 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,370 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2 union all cube select name3 from table3) u
2014-07-15 12:51:07,373 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,374 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_UNION
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table2
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name2
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table3
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name3
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,375 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,375 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,376 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,377 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,378 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,379 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,379 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,380 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@b05eb6f query:cube select name from table
2014-07-15 12:51:07,381 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,381 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,381 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,383 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@31a3ca10 query:cube select name2 from table2
2014-07-15 12:51:07,384 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,385 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,385 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,386 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@7826f9e5 query:cube select name3 from table3
2014-07-15 12:51:07,387 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,388 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,388 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,389 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,390 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,391 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,405 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,408 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,409 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,409 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,421 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,422 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,422 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,423 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name3 from table3
2014-07-15 12:51:07,434 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name3 from table3
2014-07-15 12:51:07,435 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,436 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name3 from table3
2014-07-15 12:51:07,437 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table union all  select name2 from table2 union all  select name3 from table3) u
2014-07-15 12:51:07,438 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2 union all cube select name3 from table3) u
2014-07-15 12:51:07,440 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,441 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_UNION
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table2
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name2
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table3
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name3
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,441 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,442 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,443 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,443 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,444 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,444 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,445 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,446 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@10ed32c4 query:cube select name from table
2014-07-15 12:51:07,447 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,447 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,447 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,448 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@449fea8a query:cube select name2 from table2
2014-07-15 12:51:07,449 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,449 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,449 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,450 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@5edf2d38 query:cube select name3 from table3
2014-07-15 12:51:07,451 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,452 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,452 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,454 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,454 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,455 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,469 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,470 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,471 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,472 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,486 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,487 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,488 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,489 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name3 from table3
2014-07-15 12:51:07,503 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name3 from table3
2014-07-15 12:51:07,504 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,504 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name3 from table3
2014-07-15 12:51:07,505 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table union all  select name2 from table2 union all  select name3 from table3) u
2014-07-15 12:51:07,506 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from   (     cube select name from table    union all   cube select name2 from table2   union all  cube select name3 from table3 )  u
2014-07-15 12:51:07,508 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,509 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_UNION
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table2
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name2
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table3
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name3
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,510 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,511 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,511 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,512 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,513 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,514 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,514 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,515 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@df1cbf6 query:cube select name from table
2014-07-15 12:51:07,516 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,516 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,517 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,518 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@7d858aa0 query:cube select name2 from table2
2014-07-15 12:51:07,519 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,519 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,519 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,520 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@4a504ec1 query:cube select name3 from table3
2014-07-15 12:51:07,523 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,524 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,525 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,526 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,527 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,528 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from   (     cube select name from table    union all   cube select name2 from table2   union all  cube select name3 from table3 )  u
2014-07-15 12:51:07,530 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,531 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_UNION
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table2
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name2
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table3
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name3
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,532 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,533 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,534 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,535 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,535 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,536 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,536 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,538 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@168e4805 query:cube select name from table
2014-07-15 12:51:07,539 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,539 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,539 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,541 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@571a4bd4 query:cube select name2 from table2
2014-07-15 12:51:07,541 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,542 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,542 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,543 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@7f6877f8 query:cube select name3 from table3
2014-07-15 12:51:07,544 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,545 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,546 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,547 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,548 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,548 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,562 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,563 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,564 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,564 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,578 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,579 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,580 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,580 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name3 from table3
2014-07-15 12:51:07,592 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name3 from table3
2014-07-15 12:51:07,593 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,594 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name3 from table3
2014-07-15 12:51:07,595 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from   (      select name from table    union all    select name2 from table2   union all   select name3 from table3 )  u
2014-07-15 12:51:07,596 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from   (     cube select name from table    union all   cube select name2 from table2   union all  cube select name3 from table3 )  u
2014-07-15 12:51:07,599 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,599 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_UNION
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table2
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name2
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table3
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name3
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

2014-07-15 12:51:07,600 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,601 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,602 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,603 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,603 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,604 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,604 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,606 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@98adae2 query:cube select name from table
2014-07-15 12:51:07,607 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,607 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,607 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,609 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@7b283052 query:cube select name2 from table2
2014-07-15 12:51:07,610 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,610 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,610 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,611 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@b7c96a9 query:cube select name3 from table3
2014-07-15 12:51:07,612 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,613 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,614 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,615 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,616 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,617 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,628 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,629 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,630 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,634 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,647 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,648 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,649 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,650 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name3 from table3
2014-07-15 12:51:07,662 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name3 from table3
2014-07-15 12:51:07,663 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,664 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name3 from table3
2014-07-15 12:51:07,665 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from   (      select name from table    union all    select name2 from table2   union all   select name3 from table3 )  u
2014-07-15 12:51:07,665 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2) u group by u.name
2014-07-15 12:51:07,669 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,670 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF
      TOK_GROUPBY
         .
            TOK_TABLE_OR_COL
               u
            name

2014-07-15 12:51:07,671 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,672 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,672 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,673 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,675 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,675 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,677 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@317cfd38 query:cube select name from table
2014-07-15 12:51:07,677 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,678 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,678 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,679 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@4d480ea query:cube select name2 from table2
2014-07-15 12:51:07,680 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,681 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,681 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,682 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,683 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,684 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:07,684 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,685 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,686 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2) u group by u.name
2014-07-15 12:51:07,688 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,688 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF
      TOK_GROUPBY
         .
            TOK_TABLE_OR_COL
               u
            name

2014-07-15 12:51:07,689 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,690 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,691 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,691 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,692 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,693 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,694 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@1b5b8520 query:cube select name from table
2014-07-15 12:51:07,695 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,695 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,696 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,697 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@158105e8 query:cube select name2 from table2
2014-07-15 12:51:07,698 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,699 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,700 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,700 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,701 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,702 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:07,703 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,703 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,704 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,717 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,718 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,719 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,719 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,732 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,733 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,734 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,735 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table union all  select name2 from table2) u group by u.name
2014-07-15 12:51:07,735 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2)  u group by u.name
2014-07-15 12:51:07,737 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,737 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF
      TOK_GROUPBY
         .
            TOK_TABLE_OR_COL
               u
            name

2014-07-15 12:51:07,738 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,739 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,740 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,740 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,741 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,741 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,745 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@33f98d58 query:cube select name from table
2014-07-15 12:51:07,746 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,746 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,746 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,748 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@265a2eaa query:cube select name2 from table2
2014-07-15 12:51:07,748 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,749 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,750 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,751 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,751 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,752 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:07,753 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,753 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,754 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2)  u group by u.name
2014-07-15 12:51:07,756 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,757 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF
      TOK_GROUPBY
         .
            TOK_TABLE_OR_COL
               u
            name

2014-07-15 12:51:07,758 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,759 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,759 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,760 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,761 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,762 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,763 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6aadae91 query:cube select name from table
2014-07-15 12:51:07,764 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,764 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,765 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,766 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@309fe84e query:cube select name2 from table2
2014-07-15 12:51:07,767 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,768 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,769 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,770 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,770 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,771 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:07,772 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,773 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,773 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,786 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,787 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,788 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,789 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,802 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,803 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,804 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,805 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table union all  select name2 from table2)  u group by u.name
2014-07-15 12:51:07,806 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: select * from (cube select name from table union all cube select name2 from table2)  u group by u.name
2014-07-15 12:51:07,808 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,809 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_QUERY
   TOK_FROM
      TOK_SUBQUERY
         TOK_UNION
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name
            TOK_QUERY
               cube
               TOK_FROM
                  TOK_TABREF
                     TOK_TABNAME
                        table2
               TOK_INSERT
                  TOK_DESTINATION
                     TOK_DIR
                        TOK_TMP_FILE
                  TOK_SELECT
                     TOK_SELEXPR
                        TOK_TABLE_OR_COL
                           name2
         u
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF
      TOK_GROUPBY
         .
            TOK_TABLE_OR_COL
               u
            name

2014-07-15 12:51:07,810 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,810 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,811 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,812 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,813 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,813 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,814 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@1c2006a0 query:cube select name from table
2014-07-15 12:51:07,815 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,815 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,815 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,816 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@7a9300cc query:cube select name2 from table2
2014-07-15 12:51:07,817 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,818 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,819 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,820 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,821 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,822 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:07,823 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,824 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,825 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,837 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,838 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,839 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,840 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,855 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,856 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,857 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,858 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: select * from ( select name from table union all  select name2 from table2)  u group by u.name
2014-07-15 12:51:07,859 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: create table temp1 as cube select name from table
2014-07-15 12:51:07,865 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,865 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_CREATETABLE
   TOK_TABNAME
      temp1
   TOK_LIKETABLE
   TOK_QUERY
      cube
      TOK_FROM
         TOK_TABREF
            TOK_TABNAME
               table
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_TABLE_OR_COL
                  name

2014-07-15 12:51:07,866 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,867 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:temp1 Type:26
2014-07-15 12:51:07,867 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,868 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,868 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@9642bd6 query:cube select name from table
2014-07-15 12:51:07,869 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: create table temp1 as cube select name from table
2014-07-15 12:51:07,870 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,871 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_CREATETABLE
   TOK_TABNAME
      temp1
   TOK_LIKETABLE
   TOK_QUERY
      cube
      TOK_FROM
         TOK_TABREF
            TOK_TABNAME
               table
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_TABLE_OR_COL
                  name

2014-07-15 12:51:07,872 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,873 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:temp1 Type:26
2014-07-15 12:51:07,873 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,874 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,875 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@f79f36b query:cube select name from table
2014-07-15 12:51:07,875 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,889 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,890 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,892 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,893 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: create table temp1 as  select name from table
2014-07-15 12:51:07,894 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: create table temp1 as cube select name from table
2014-07-15 12:51:07,894 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,895 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_CREATETABLE
   TOK_TABNAME
      temp1
   TOK_LIKETABLE
   TOK_QUERY
      cube
      TOK_FROM
         TOK_TABREF
            TOK_TABNAME
               table
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_TABLE_OR_COL
                  name

2014-07-15 12:51:07,895 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,896 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:temp1 Type:26
2014-07-15 12:51:07,897 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,897 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,897 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@77bc1fb9 query:cube select name from table
2014-07-15 12:51:07,898 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,909 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,910 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,910 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,911 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: create table temp1 as  select name from table
2014-07-15 12:51:07,911 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: create table temp1 as select * from (cube select name from table union all cube select name2 from table2)  u group by u.name
2014-07-15 12:51:07,913 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,913 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_CREATETABLE
   TOK_TABNAME
      temp1
   TOK_LIKETABLE
   TOK_QUERY
      TOK_FROM
         TOK_SUBQUERY
            TOK_UNION
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table2
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name2
            u
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_ALLCOLREF
         TOK_GROUPBY
            .
               TOK_TABLE_OR_COL
                  u
               name

2014-07-15 12:51:07,914 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,915 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:temp1 Type:26
2014-07-15 12:51:07,915 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,916 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,916 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,917 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,917 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,918 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,919 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@7bafb0c7 query:cube select name from table
2014-07-15 12:51:07,919 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,919 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,920 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,920 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@4b7f1841 query:cube select name2 from table2
2014-07-15 12:51:07,921 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,921 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,922 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,922 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,923 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,923 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:07,924 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,924 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,925 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: create table temp1 as select * from (cube select name from table union all cube select name2 from table2)  u group by u.name
2014-07-15 12:51:07,927 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,928 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_CREATETABLE
   TOK_TABNAME
      temp1
   TOK_LIKETABLE
   TOK_QUERY
      TOK_FROM
         TOK_SUBQUERY
            TOK_UNION
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table2
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name2
            u
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_ALLCOLREF
         TOK_GROUPBY
            .
               TOK_TABLE_OR_COL
                  u
               name

2014-07-15 12:51:07,928 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,929 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:temp1 Type:26
2014-07-15 12:51:07,930 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,930 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,931 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,932 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,932 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,932 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,933 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@5117a20 query:cube select name from table
2014-07-15 12:51:07,934 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,934 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,934 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,935 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@3e68cd79 query:cube select name2 from table2
2014-07-15 12:51:07,936 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,936 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,937 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,938 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,938 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,939 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:07,940 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,947 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,948 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:07,960 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:07,960 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,961 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:07,962 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:07,971 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:07,972 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,972 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:07,973 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: create table temp1 as select * from ( select name from table union all  select name2 from table2)  u group by u.name
2014-07-15 12:51:07,974 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: create table temp1 as select * from (cube select name from table union all cube select name2 from table2)  u group by u.name
2014-07-15 12:51:07,976 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:07,977 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_CREATETABLE
   TOK_TABNAME
      temp1
   TOK_LIKETABLE
   TOK_QUERY
      TOK_FROM
         TOK_SUBQUERY
            TOK_UNION
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name
               TOK_QUERY
                  cube
                  TOK_FROM
                     TOK_TABREF
                        TOK_TABNAME
                           table2
                  TOK_INSERT
                     TOK_DESTINATION
                        TOK_DIR
                           TOK_TMP_FILE
                     TOK_SELECT
                        TOK_SELEXPR
                           TOK_TABLE_OR_COL
                              name2
            u
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_ALLCOLREF
         TOK_GROUPBY
            .
               TOK_TABLE_OR_COL
                  u
               name

2014-07-15 12:51:07,978 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:07,978 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:temp1 Type:26
2014-07-15 12:51:07,979 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_FROM Type:672
2014-07-15 12:51:07,980 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SUBQUERY Type:816
2014-07-15 12:51:07,980 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_UNION Type:870
2014-07-15 12:51:07,981 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_QUERY Type:767
2014-07-15 12:51:07,982 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,982 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,983 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@7a20807c query:cube select name from table
2014-07-15 12:51:07,984 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:07,984 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:07,984 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:108)] Child of union all
2014-07-15 12:51:07,985 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@6bd38b87 query:cube select name2 from table2
2014-07-15 12:51:07,986 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DESTINATION Type:649
2014-07-15 12:51:07,987 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_DIR Type:650
2014-07-15 12:51:07,988 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TMP_FILE Type:866
2014-07-15 12:51:07,989 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_SELEXPR Type:783
2014-07-15 12:51:07,990 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_ALLCOLREF Type:581
2014-07-15 12:51:07,991 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:. Type:17
2014-07-15 12:51:07,992 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABLE_OR_COL Type:848
2014-07-15 12:51:07,993 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:u Type:26
2014-07-15 12:51:07,994 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table
2014-07-15 12:51:08,005 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table
2014-07-15 12:51:08,006 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:08,007 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table
2014-07-15 12:51:08,008 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name2 from table2
2014-07-15 12:51:08,016 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name2 from table2
2014-07-15 12:51:08,017 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:08,018 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name2 from table2
2014-07-15 12:51:08,019 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: create table temp1 as select * from ( select name from table union all  select name2 from table2)  u group by u.name
2014-07-15 12:51:08,020 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: create table temp1 as cube select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,024 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:08,024 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_CREATETABLE
   TOK_TABNAME
      temp1
   TOK_LIKETABLE
   TOK_QUERY
      cube
      TOK_FROM
         TOK_TABREF
            TOK_TABNAME
               table
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_TABLE_OR_COL
                  name
         TOK_WHERE
            TOK_FUNCTION
               time_range_in
               'dt'
               '2014-06-24-23'
               '2014-06-25-00'

2014-07-15 12:51:08,025 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:08,026 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:temp1 Type:26
2014-07-15 12:51:08,026 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:08,027 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:08,027 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@92696c2 query:cube select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,028 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: create table temp1 as cube select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,030 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:08,030 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_CREATETABLE
   TOK_TABNAME
      temp1
   TOK_LIKETABLE
   TOK_QUERY
      cube
      TOK_FROM
         TOK_TABREF
            TOK_TABNAME
               table
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_TABLE_OR_COL
                  name
         TOK_WHERE
            TOK_FUNCTION
               time_range_in
               'dt'
               '2014-06-24-23'
               '2014-06-25-00'

2014-07-15 12:51:08,031 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:08,032 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:temp1 Type:26
2014-07-15 12:51:08,032 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:08,032 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:08,033 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@44739f3f query:cube select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,034 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,044 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,046 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:08,047 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,048 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: create table temp1 as  select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,049 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command: create table temp1 as cube select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,051 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:08,052 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:58)] User query AST:
TOK_CREATETABLE
   TOK_TABNAME
      temp1
   TOK_LIKETABLE
   TOK_QUERY
      cube
      TOK_FROM
         TOK_TABREF
            TOK_TABNAME
               table
      TOK_INSERT
         TOK_DESTINATION
            TOK_DIR
               TOK_TMP_FILE
         TOK_SELECT
            TOK_SELEXPR
               TOK_TABLE_OR_COL
                  name
         TOK_WHERE
            TOK_FUNCTION
               time_range_in
               'dt'
               '2014-06-24-23'
               '2014-06-25-00'

2014-07-15 12:51:08,053 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:TOK_TABNAME Type:851
2014-07-15 12:51:08,062 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:temp1 Type:26
2014-07-15 12:51:08,063 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:73)] First child:cube Type:66
2014-07-15 12:51:08,063 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:77)] Inside cube clause
2014-07-15 12:51:08,064 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.findCubePositions(RewriteUtil.java:113)] Adding cqi com.inmobi.grill.driver.cube.RewriteUtil$CubeQueryInfo@2bdafb4e query:cube select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,064 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:194)] Rewriting cube query:cube select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,073 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:185)] Parsing command:  select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,075 (main) [INFO - org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:206)] Parse Completed
2014-07-15 12:51:08,076 (main) [DEBUG - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:199)] Rewritten query: select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
2014-07-15 12:51:08,077 (main) [INFO - com.inmobi.grill.driver.cube.RewriteUtil.rewriteQuery(RewriteUtil.java:205)] Final rewritten query for driver:com.inmobi.grill.driver.cube.MockDriver@57d840cd is: create table temp1 as  select name from table where time_range_in('dt', '2014-06-24-23', '2014-06-25-00')
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.296 sec - in com.inmobi.grill.driver.cube.TestRewriting

Results :

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 11.124s
[INFO] Finished at: Tue Jul 15 12:51:08 GMT+05:30 2014
[INFO] Final Memory: 20M/81M
[INFO] ------------------------------------------------------------------------
