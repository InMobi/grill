<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-02-27
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20150227" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Lens &#x2013; </title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href=".././" id="bannerLeft">
                                                                                                <img src="../images/apache-lens-logo.png"  alt="Lens Analytics Platform" height="54px"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="http://incubator.apache.org" id="bannerRight">
                                                                                                <img src="../images/apache-incubator-logo.png"  alt="Apache Incubator"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="http://www.apache.org" class="externalLink" title="Apache">
        Apache</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href=".././" title="Lens">
        Lens</a>
        </li>
      <li class="divider ">/</li>
        <li class=""></li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 2015-02-27</li> <li class="divider pull-right">|</li>
              <li id="projectVersion" class="pull-right">Version: 2.1.0-inm-SNAPSHOT</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Lens</li>
                                
      <li>
    
                          <a href="../index.html" title="Overview">
          <i class="none"></i>
        Overview</a>
            </li>
                  
      <li>
    
                          <a href="../lenshome/quick-start.html" title="Getting Started">
          <i class="none"></i>
        Getting Started</a>
            </li>
                  
      <li>
    
                          <a href="../lenshome/install-and-run.html" title="Installing and Running Lens">
          <i class="none"></i>
        Installing and Running Lens</a>
            </li>
                  
      <li>
    
                          <a href="../lenshome/pseudo-distributed-setup.html" title="Pseudo Distributed Setup">
          <i class="none"></i>
        Pseudo Distributed Setup</a>
            </li>
                              <li class="nav-header">Releases</li>
                                
      <li>
    
                          <a href="../releases/download.html" title="Download">
          <i class="none"></i>
        Download</a>
            </li>
                  
      <li>
    
                          <a href="../releases/compatibility.html" title="Compatibility">
          <i class="none"></i>
        Compatibility</a>
            </li>
                  
      <li>
    
                          <a href="../releases/release-history.html" title="All Releases">
          <i class="none"></i>
        All Releases</a>
            </li>
                              <li class="nav-header">User Documentation</li>
                                
      <li>
    
                          <a href="../user/index.html" title="Lens User Guide">
          <i class="none"></i>
        Lens User Guide</a>
            </li>
                  
      <li>
    
                          <a href="../user/olap-cube.html" title="OLAP data cube">
          <i class="none"></i>
        OLAP data cube</a>
            </li>
                  
      <li>
    
                          <a href="../rest.html" title="REST API">
          <i class="none"></i>
        REST API</a>
            </li>
                  
      <li>
    
                          <a href="../user/cli.html" title="Lens CLI">
          <i class="none"></i>
        Lens CLI</a>
            </li>
                  
      <li>
    
                          <a href="../user/java-client.html" title="Java Client Library">
          <i class="none"></i>
        Java Client Library</a>
            </li>
                  
      <li>
    
                          <a href="../user/jdbc-client.html" title="JDBC Client">
          <i class="none"></i>
        JDBC Client</a>
            </li>
                  
      <li>
    
                          <a href="../user/ml.html" title="Lens ML">
          <i class="none"></i>
        Lens ML</a>
            </li>
                  
      <li>
    
                          <a href="../user/faq.html" title="FAQ">
          <i class="none"></i>
        FAQ</a>
            </li>
                              <li class="nav-header">Developer Documentation</li>
                                
      <li>
    
                          <a href="../developer/contribute.html" title="Contributor Guide">
          <i class="none"></i>
        Contributor Guide</a>
            </li>
                  
      <li>
    
                          <a href="../developer/commit.html" title="Committer Guide">
          <i class="none"></i>
        Committer Guide</a>
            </li>
                  
      <li>
    
                          <a href="../developer/design.html" title="Lens Design">
          <i class="none"></i>
        Lens Design</a>
            </li>
                  
      <li>
    
                          <a href="../developer/driver.html" title="Driver Developer Guide">
          <i class="none"></i>
        Driver Developer Guide</a>
            </li>
                              <li class="nav-header">Admin Documentation</li>
                                
      <li>
    
                          <a href="../admin/index.html" title="Admin Overview">
          <i class="none"></i>
        Admin Overview</a>
            </li>
                  
      <li>
    
                          <a href="../admin/deployment.html" title="Deployment">
          <i class="none"></i>
        Deployment</a>
            </li>
                  
      <li>
    
                          <a href="../admin/config-server.html" title="Configuration">
          <i class="none"></i>
        Configuration</a>
            </li>
                  
      <li>
    
                          <a href="../admin/cli.html" title="Admin CLI">
          <i class="none"></i>
        Admin CLI</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                      
      <li>
    
                          <a href="../project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                    
      <li>
    
                          <a href="../project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                         <a href="http://www.apache.org/" title="ASF" class="builtBy">
        <img class="builtBy"  alt="ASF" src="../images/logos/maven-feather.png"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!--  --><!-- Licensed to the Apache Software Foundation (ASF) under one --><!-- or more contributor license agreements.  See the NOTICE file --><!-- distributed with this work for additional information --><!-- regarding copyright ownership.  The ASF licenses this file --><!-- to you under the Apache License, Version 2.0 (the --><!-- "License"); you may not use this file except in compliance --><!-- with the License.  You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, --><!-- software distributed under the License is distributed on an --><!-- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY --><!-- KIND, either express or implied.  See the License for the --><!-- specific language governing permissions and limitations --><!-- under the License. --><!--  --><div class="section">
<h2><a name="Query_results"></a>Query results</h2>
<p>This document contains details on query result - fetching, formatting and etc.</p>
<p>Lens query service allows users to fetch results of query by specifying the handle-id. It provides rest api to fetch result-metadata and the results.</p>
<p>Here are various options provided for result formatting and fetching:</p>
<div class="section">
<h3><a name="Persisting_results_by_server"></a>Persisting results by server</h3>
<p>Server can persists the results in configured location, also format the results of the query, with a custom format.</p>
<p>User can provide a custom output formatter which implements <a href="../apidocs/org/apache/lens/server/api/query/InMemoryOutputFormatter.html">InMemoryOutputFormatter</a> or <a href="../apidocs/org/apache/lens/server/api/query/PersistedOutputFormatter.html">PersistedOutputFormatter</a></p>
<p>Default implementation of formatting offers writing it into a file, but a new implementation can be provided which persist in a db or whatever.</p>
<p>The file based formatting provides following options:</p>
<ul>
<li>Optionally write header</li>
<li>Format the rows of the results like csv, or separate them with ctrl character characters, which can be described through a Hive SerDe.</li>
<li>Optionally write the output with a charset encoding.</li>
<li>Optionally write footer</li>
<li>Provide an extension to the file name</li>
<li>Optionally compress the file</li>
<li>Skip formatting if result size exceeds a configured threshold</li>
<li>Optionally allow result to be split into multiple files, with configured number of rows in ech file.</li></ul></div>
<div class="section">
<h3><a name="Persisting_results_by_driver"></a>Persisting results by driver</h3>
<p>The driver can persist the query output in a location. When driver persists the results, the rows of the result can be formatted by the driver.</p>
<p>HiveDriver allows users to specify the format of the result through a configuration. It will persist the result in queryhandle-id directory inside hdfsout directory in the parent result directory. </p>
<p>Since persisting the results by driver only allows formatting of the rows, if user requires further formatting, the results should be persisted by server again.</p></div>
<div class="section">
<h3><a name="Formatting_summary"></a>Formatting summary</h3>
<p>Below table depicts all the formatting options provided by query service</p>
<table border="1" class="table table-striped">
<tr class="a">
<td align="left">Formatting of the results</td>
<td align="left"><b>Not persisted by driver</b></td>
<td align="left"><b>Persisted by driver</b></td></tr>
<tr class="b">
<td align="left"><b>Not persisted by server</b></td>
<td align="left">No formatting</td>
<td align="left">Row level formatting</td></tr>
<tr class="a">
<td align="left"><b>Persisted by server</b></td>
<td align="left">All query output formatting</td>
<td align="left">All query output formatting on top of row level formatting done by driver</td></tr></table>
<p>See <a href="../admin/config.html"> here</a> for all the configuration property names</p></div>
<div class="section">
<h3><a name="Fetching_the_results"></a>Fetching the results</h3>
<p>If the results are persisted either by server or driver, the user would get the result set as PersistentQueryResult. If results are not persisted, then user would get the result as InMemoryQueryResult.</p>
<table border="1" class="table table-striped">
<tr class="a">
<td align="left">ResultSet</td>
<td align="left"><b>Not persisted by driver</b></td>
<td align="left"><b>Persisted by driver</b></td></tr>
<tr class="b">
<td align="left"><b>Not persisted by server</b></td>
<td align="left">InMemoryQueryResult</td>
<td align="left">PersistentQueryResult</td></tr>
<tr class="a">
<td align="left"><b>Persisted by server</b></td>
<td align="left">PersistentQueryResult</td>
<td align="left">PersistentQueryResult</td></tr></table>
<p>If results are persisted by server, user can get the result as a http end point, which he can download or see it in the browser. The http result set can be obtained by the rest endpoint <a href="../resource_QueryServiceResource.html#path__queryapi_queries_-queryHandle-_httpresultset.html">/queryapi/queries/queryhandle/httpresultresult</a></p>
<p>The results can be fetched as PersistentQueryResult or InMemoryQueryResult from the end point <a href="../resource_QueryServiceResource.html#path__queryapi_queries_-queryHandle-_resultset.html">/queryapi/queries/queryhandle/resultresult</a></p></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2014-2015
                        <a href="http://www.apache.org">Apache Software Foundation</a>.
            All Rights Reserved.      
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
