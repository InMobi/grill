<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2014-09-25 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Grill - </title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20140925" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                        <a href="http://inmobi.github.io/grill" id="bannerLeft">
                                        <img src="http://inmobi.github.io/grill/grill-logo.png" alt="Grill Analytics Platform for InMobi" title="Grill Analytics Platform" />
                </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
                                  <a href="../.." title="InMobi">InMobi</a>
        &gt;
                          <a href=".././" title="Grill">Grill</a>
        &gt;
    
      </div>
            <div class="xright">        
                    
                 <span id="publishDate">Last Published: 2014-09-25</span>
              &nbsp;| <span id="projectVersion">Version: 1.1.1-SNAPSHOT</span>
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Grill</h5>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="../gettingstarted/quick-start.html" title="Getting Started">Getting Started</a>
            </li>
                  <li class="none">
                          <a href="../gettingstarted/install-steps.html" title="Install and Run">Install and Run</a>
            </li>
                  <li class="none">
                          <a href="../gettingstarted/pseudo-distributed-setup.html" title="Pseudo Distributed Setup">Pseudo Distributed Setup</a>
            </li>
          </ul>
                       <h5>User Documentation</h5>
                  <ul>
                  <li class="none">
            <strong>Grill User Guide</strong>
          </li>
                  <li class="none">
                          <a href="../user/olap-cube.html" title="OLAP data cube">OLAP data cube</a>
            </li>
                  <li class="none">
                          <a href="../rest.html" title="REST API">REST API</a>
            </li>
                  <li class="none">
                          <a href="../user/cli.html" title="Grill CLI">Grill CLI</a>
            </li>
                  <li class="none">
                          <a href="../user/java-client.html" title="Java Client Library">Java Client Library</a>
            </li>
                  <li class="none">
                          <a href="../user/jdbc-client.html" title="JDBC Client">JDBC Client</a>
            </li>
                  <li class="none">
                          <a href="../user/faq.html" title="FAQ">FAQ</a>
            </li>
          </ul>
                       <h5>Developer Documentation</h5>
                  <ul>
                  <li class="none">
                          <a href="../developer/design.html" title="Grill Design">Grill Design</a>
            </li>
                  <li class="none">
                          <a href="../developer/driver.html" title="Driver Developer Guide">Driver Developer Guide</a>
            </li>
          </ul>
                       <h5>Admin Documentation</h5>
                  <ul>
                  <li class="none">
                          <a href="../admin/index.html" title="Admin Overview">Admin Overview</a>
            </li>
                  <li class="none">
                          <a href="../admin/deployment.html" title="Deployment">Deployment</a>
            </li>
                  <li class="none">
                          <a href="../admin/config-server.html" title="Configuration">Configuration</a>
            </li>
                  <li class="none">
                          <a href="../admin/cli.html" title="Admin CLI">Admin CLI</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                        <li class="collapsed">
                          <a href="../project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="../project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                                                                                                                                     <a href="http://www.inmobi.com/" title="inmobi" class="poweredBy">
        <img class="poweredBy"  alt="inmobi" src="../../images/inmobi-logo.jpg"     />
      </a>
                       
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!-- ~ --><!-- #%L --><!-- Grill --><!-- %% --><!-- Copyright (C) 2014 Inmobi --><!-- %% --><!-- Licensed under the Apache License, Version 2.0 (the "License"); --><!-- you may not use this file except in compliance with the License. --><!-- You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, software --><!-- distributed under the License is distributed on an "AS IS" BASIS, --><!-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. --><!-- See the License for the specific language governing permissions and --><!-- limitations under the License. --><!-- #L% --><!-- ~ --><div class="section">
<h2>Grill User Guide<a name="Grill_User_Guide"></a></h2>
<ul>
<li><a href="#Grill_User_Guide">Grill User Guide</a>
<ul>
<li><a href="#Overview">Overview</a></li>
<li><a href="#Configuration">Configuration</a></li>
<li><a href="#Session_Service">Session Service</a></li>
<li><a href="#Query_Execution_Service">Query Execution Service</a>
<ul>
<li><a href="#Query_Submission_Workflow">Query Submission Workflow</a></li>
<li><a href="#Getting_query_results">Getting query results</a></li>
<li><a href="#Life_of_a_Query_in_the_Grill_Server">Life of a Query in the Grill Server</a></li>
<li><a href="#Prepared_queries">Prepared queries</a></li></ul></li>
<li><a href="#Metastore_service">Metastore service</a></li>
<li><a href="#Quota_service">Quota service</a></li></ul></li></ul>
<div class="section">
<h3>Overview<a name="Overview"></a></h3>
<p>Grill Server runs several services which can be used from their REST endpoints. This document covers some of the important services, their purpose and key API calls.</p>
<p>Grill server provides metastore service for managing metadata. Metadata exposed by grill is inspired by OLAP data cubes. See <a href="./olap-cube.html#Metastore_model"> Metastore Model</a> for metastore constructs that grill provides.</p>
<p>Grill server also provides query service for querying data exposed by grill. See <a href="./olap-cube.html#Query_Language"> Query Language</a> for the grammar of the query.</p>
<p>To access any service on grill, user should be working in a session. User can also pass various configuration parameters from client.</p>
<p>The sections below give more details on each service and configuration. </p></div>
<div class="section">
<h3>Configuration<a name="Configuration"></a></h3>
<p>Client configuration can be overridden in grill-client-site.xml. See <a href="./client-config.html">client configuration</a> for all the configuration parameters available and their default values.</p></div>
<div class="section">
<h3>Session Service<a name="Session_Service"></a></h3>
<p>To use any Grill service the user must first create a session. Each Grill session is associated with a unique session handle, which must be passed when making queries, or doing metadata operations in the same session. To check if the session service is deployed in the Grill Server, user can send a GET request to /session. An OK response means that the session service is deployed. </p>
<p>Sessions also allow users to set configuration or resources which could be shared across a group of queries. For example, if a group of queries need to call a UDF available in some specific jar, then the jar file can be added as a resource in the session. All queries started within the same session can make use of the jar file.</p>
<p>GRILL provides <a href="../resource_SessionResource.html"> REST api</a>, <a href="../apidocs/com/inmobi/grill/client/GrillConnection.html"> Java client api</a> and <a href="./cli.html#Session_management"> CLI</a> for doing all session level operations.</p>
<p>The important API calls exposed by the session resource are -</p>
<ul>
<li><a href="../resource_SessionResource.html#path__session.html">/session</a> - Endpoint to create or delete a session. </li>
<li><a href="../resource_SessionResource.html#path__session_params.html">/session/params</a> - Endpoint to maintain session settings</li>
<li><a href="../resource_SessionResource.html#path__session_resources_add.html">/session/resources</a> - Adding or removing resources from the session</li></ul></div>
<div class="section">
<h3>Query Execution Service<a name="Query_Execution_Service"></a></h3>
<p>The <a href="../resource_QueryServiceResource.html">Query Execution Service</a> is used to query data exposed by Grill. </p>
<div class="section">
<h4>Query Submission Workflow<a name="Query_Submission_Workflow"></a></h4>
<ul>
<li>Create a session using the session service</li>
<li>Submit a query by sending a POST to the <tt>/queryapi/queries</tt> endpoint. By default this call should return immediately with the query handle of the newly created query. Each query in Grill is associated with a unique query handle. Query handle can be used to check query status and get results. If users wish to submit an interactive query which finishes fast, the '<tt>op</tt>' parameter must be set to <tt>EXECUTE_WITH_TIMEOUT</tt>. This behaviour is explained in detail below.</li>
<li>In case of async execution, poll for query status by sending a GET to <tt>/queryapi/queries/queryhandle}</tt>. Once the query reaches <b>SUCCESSFUL</b> state, its results can be retrieved using the <tt>/queryapi/queries/<a name="queryhandle">queryhandle</a>/resultset</tt> endpoint.</li>
<li>By default the create query call returns immediately. This behaviour is intended to suit batch queries. However, for interactive queries it may be necessary to issue the query and get its result in a single call to the server. For such cases the create query call takes an 'op' argument. If the op parameter is set to <tt>EXECUTE_WITH_TIMEOUT</tt>, then an additional <tt>timeout</tt> value must also be passed. If the query completes before this timeout is reached, the call immediately returns with the query result set. If however, the query doesn't finish, only the query handle is returned, and users can further poll for query status and fetch results when the query is <b>SUCCESSFUL</b>.</li>
<li>At any time, user can cancel the execution of the query by sending a DELETE to <tt>/queryapi/queries/<a name="queryhandle">queryhandle</a></tt></li></ul>
<p>To summarize, given below are steps for batch (async) queries</p>
<ol style="list-style-type: decimal">
<li>Create session, note returned session handle.</li>
<li>Create query by passing session handle, note returned query handle.</li>
<li>Poll for query status by passing session handle and query handle.</li>
<li>If query is SUCCESSFUL, get results.</li></ol>
<p>Steps for interactive queries.</p>
<ol style="list-style-type: decimal">
<li>Create a session.</li>
<li>Create a query by setting <tt>op=EXECUTE_WITH_TIMEOUT</tt>, Also set the <tt>timeout</tt> value.</li>
<li>Check the response, if it contains only the query handle, then poll for status as is the case in async queries. If it contains both query handle and result set, then that means query did complete successfully within the timeout. </li></ol></div>
<div class="section">
<h4>Getting query results<a name="Getting_query_results"></a></h4>
<p>A query can be run once, but its results can be fetched any number of times, if the results are persisted, until its purged from server memory. Results can be obtained by sending a GET to <tt>/queryapi/queries/<a name="queryhandle">queryhandle</a>/resultset</tt>. This endpoint takes optional <tt>fromindex</tt> and <tt>fetchsize</tt> parameters which can be used for pagination of results.</p>
<p>Various query result formatting and fetching options are described in <a href="./query-results.html"> query result doc</a>.</p></div>
<div class="section">
<h4>Life of a Query in the Grill Server<a name="Life_of_a_Query_in_the_Grill_Server"></a></h4>
<p>The following diagram shows query state transition in the Grill Server </p><img src="../figures/querystate.png" alt="Query States in Grill" />
<p>When user submits a query to the Grill Server, its starts in the <b>NEW</b> state. After the query is submitted, it moves into the <b>QUEUED</b> state. Until Grill server is free to take up the query, it remains in the <b>QUEUED</b> state. As soon as Grill server starts processing the query, it enters the <b>LAUNCHED</b> state. At this stage Grill has decided which backend engine will be used to execute the query. </p>
<p>For each query Grill server will poll the chosen backend engine for query status. A GET on the query endpoint returns the latest status of the query.</p>
<p>The <b>RUNNING</b> state indicates that the query is currently being processed by the query backend. </p>
<p>After the <b>RUNNING</b> state, the query can enter either the <b>SUCCESSFUL</b> or <b>FAILED</b> states, depending on the result of query execution. If the query is <b>SUCCESSFUL</b>, its result set can be retrieved using the result set API call, by passing the session handle and query handle. The query can be executed once, and its results can be fetched multiple times unless the query has been purged from Grill server state.</p>
<p>In any state, if the user requests that the query be cancelled, the query will enter into <b>CANCELLED</b> state. Query can be cancelled by sending a DELETE at the query endpoint. </p>
<p><b>FAILED</b>, <b>SUCCESSFUL</b> and <b>CANCELLED</b> are end states for a query. Once a query reaches these states, it becomes eligible to purging. The query is purged when its purge delay expires, after which it is not possible to retrieve results of the query. This purge delay is configurable. After purging the query enters the <b>CLOSED</b> state.</p></div>
<div class="section">
<h4>Prepared queries<a name="Prepared_queries"></a></h4>
<p>A query can be prepared for execution. Once prepared the query can be submitted for execution as many times as required. When prepared query is no longer required, it should be destroyed. REST api, JavaClient api and CLI commands are available for all the operations supported.</p>
<ul>
<li><a href="../resource_QueryServiceResource.html#path__queryapi_preparedqueries.html">Rest api for prepared queries</a></li>
<li><a href="../resource_QueryServiceResource.html#path__queryapi_preparedqueries_-prepareHandle-.html">Rest api for handling a prepared query</a></li>
<li><a href="../apidocs/com/inmobi/grill/client/GrillStatement.html"> Java client api</a></li>
<li><a href="./cli.html#Query_Management"> CLI query management</a></li></ul></div></div>
<div class="section">
<h3>Metastore service<a name="Metastore_service"></a></h3>
<p>The Metastore service is used for DDL operations like creating, updating cubes, fact tables and dimensions. It also pprovides endpoints to create storage tables and to add partitions to a storage table. For more detailed information see the <a href="../resource_MetastoreResource.html">metastore service resource</a> documentation.</p>
<p>For resource exposed endpoint for cubes, facts, dimensions and storage tables. For each of the resource, HTTP methods specify the operation to be performed. For example, a POST on the cubes resource creates a cube, whereas a GET on the cubes reource will get list of all cubes. Similar convention is followed for fact, dimension, and storage tables.</p>
<p>For Java clients, JAXB classes corresponding to each of the endpoints are available.</p></div>
<div class="section">
<h3>Quota service<a name="Quota_service"></a></h3></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2014
                        <a href="http://www.inmobi.com">Inmobi</a>.
            All Rights Reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
